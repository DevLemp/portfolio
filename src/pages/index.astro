---
import fs from "fs";
import path from "path";
import matter from "gray-matter";
import ProjectCard from "../components/ProjectCard.astro";
import site from "../data/site.json";
import ContentMarkdown from "../components/ContentMarkdown.astro";

// Load all projects
const projectsDir = path.resolve('./src/content/projects');
const filenames = fs.readdirSync(projectsDir);
const projects = filenames.map((name) => {
  const file = fs.readFileSync(path.join(projectsDir, name), 'utf-8');
  const { data, content } = matter(file);
  return { ...data, description: content };
});
---

<html lang="en" class="scroll-smooth">
  <head>
    <title>{site.name} - {site.title}</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  </head>
  <body class="bg-gray-50 text-gray-800 font-sans">
    <!-- Hero Section -->
    <header class="bg-white shadow py-16">
      <div class="container mx-auto text-center px-6">
        <h1 class="text-5xl md:text-6xl font-bold mb-4">{site.hero.headline}</h1>
        <p class="text-lg md:text-xl mb-6">{site.hero.subtitle}</p>
        <a href={site.hero.ctaUrl} class="inline-block px-8 py-4 bg-blue-600 text-white rounded-lg font-semibold shadow hover:bg-blue-700 transition">
          {site.hero.ctaLabel}
        </a>
      </div>
    </header>

    <main class="container mx-auto px-6 py-16">
      <!-- Projects Section -->
      <section id="projects" class="mb-20">
        <h2 class="text-4xl font-bold mb-8 text-center">Projects</h2>
        <div class="grid gap-8 md:grid-cols-2">
          {projects.map(project => <ProjectCard project={project} />)}
        </div>
      </section>

      <!-- About Section -->
      <section id="about" class="mb-20">
        <h2 class="text-4xl font-bold mb-6 text-center">About Me</h2>
        <div class="prose max-w-3xl mx-auto">
          <ContentMarkdown src="./src/content/about.md" />
        </div>
      </section>

      <!-- Contact Section -->
      <section id="contact" class="mb-20">
        <h2 class="text-4xl font-bold mb-6 text-center">Contact</h2>
        <div class="text-center space-y-3">
          <a href={"mailto:" + site.email} class="text-blue-600 hover:underline text-lg">{site.email}</a>
          <a href={site.github} target="_blank" class="text-blue-600 hover:underline text-lg">{site.github}</a>
          <a href={site.linkedin} target="_blank" class="text-blue-600 hover:underline text-lg">{site.linkedin}</a>
        </div>
      </section>
    </main>
  </body>
</html>
