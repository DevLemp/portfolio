---
import ProjectCard from "../components/ProjectCard.astro";
import fs from "fs";
import path from "path";
import matter from "gray-matter";

// Load all project Markdown files
const projectsDir = path.resolve('./src/content/projects');
const filenames = fs.readdirSync(projectsDir);
const projects = filenames.map((name) => {
  const file = fs.readFileSync(path.join(projectsDir, name), 'utf-8');
  const { data, content } = matter(file);
  return { ...data, description: content };
});

// Load site config
import site from "../data/site.json";
---

<html lang="en">
  <head>
    <title>{site.name} - {site.title}</title>
  </head>
  <body>
    <header>
      <h1>{site.hero.headline}</h1>
      <p>{site.hero.subtitle}</p>
      <a href={site.hero.ctaUrl}>{site.hero.ctaLabel}</a>
    </header>

    <section id="projects">
      <h2>Projects</h2>
      <div class="grid gap-4">
        {projects.map(project => <ProjectCard project={project} />)}
      </div>
    </section>
  </body>
</html>
